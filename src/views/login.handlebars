{{> headerhome}}
<div class="login-container">
  <form id="loginForm">

    <div class="form-group">
      <label for="email">Correo electr칩nico:</label>
      <input type="email" id="email" name="email" required placeholder="ejemplo@correo.com">
    </div>

    <div class="form-group">
      <label for="password">Contrase침a:</label>
      <input type="password" id="password" name="password" required placeholder="Tu contrase침a">
    </div>

<div>
    <button type="submit">Entrar</button>

</div>
<div>
  <a href="register">Registrarse</a>
  <a href="recoverpassemail">Recuperar contrase침a</a>
</div>
  </form>

  {{#if err}}
  <p class="error">{{err}}</p>
  {{/if}}

</div>


<script>
  document.getElementById('loginForm').addEventListener('submit', async (event) => {
    event.preventDefault()

    console.log('registro')

    const email = document.getElementById('email').value
    const password = document.getElementById('password').value

    try {
      const response = await fetch('http://localhost:8080/api/sessions/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email, password }),
        credentials: 'include'
      })

      if (response.ok) {

        const data = await response.json()
        console.log(data);


        window.location.href = '/'

      } else {
        const errorData = await response.json()
        console.log(errorData)

        window.location.href = `/users/login/?err=${errorData.error}`


      }

    } catch (error) {
      console.error('Error de red o del servidor:', error)

    }
  })
</script>